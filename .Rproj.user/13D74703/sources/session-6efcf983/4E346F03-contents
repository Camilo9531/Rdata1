#PRUEBA 1 CAMILO AGURTO

#Valores sin notacion cientifica
options(scipen=999)

#Borrar memoria de trabajo
rm(list=ls())

#Establecer directorio de trabajo
setwd("C:/Users/Camilo Agurto/OneDrive/Desktop/SOCIOLOGIA/ultimo semestre/Estadistica 3/Prueba1")
library(stargazer)
library(broom)
library(readr)
library(dplyr)
library(haven)
library(sjPlot)
library(sjmisc)
library(tidyverse)
library(ggplot2)
library(psych)
library(rio)

nac <- rio::import("C:/Users/Camilo Agurto/OneDrive/Desktop/SOCIOLOGIA/ultimo semestre/Estadistica 3/Prueba1/nacimientos.xlsx")

names(nac)

# 1. Graficos de dispersion 

# peso y edad de la madre

ggplot(nac, aes(x = edad_madre, y = peso)) +
  geom_point() +
  labs(x = "edad_madre", y = "peso")

#peso y semanas

ggplot(nac, aes(x = semanas, y = peso)) +
  geom_point() +
  labs(x = "semanas", y = "peso")

#peso y educacion de la madre

ggplot(nac, aes(x = educ_madre, y = peso)) +
  geom_point() +
  labs(x = "educ_madre", y = "peso")

# 2. Correlacion de pearson

cor(nac[,c("edad_madre","peso")], use="complete.obs")

cor(nac[,c("semanas","peso")], use="complete.obs")

cor(nac[,c("educ_madre","peso")], use="complete.obs")

#test de hipotesis

test <- cor.test(nac$peso, nac$semanas, conf.level = 0.99)

print(test)

# Modelo de regresion estimado (y= peso, x= semanas)

modelo<-lm(peso ~ semanas, data = nac)
stargazer(modelo, type = "text", title = "Resultados del Modelo de Regresión Lineal")
grafico <- ggplot(nac, aes(x = semanas, y = peso)) +
  geom_point() + 
  geom_smooth(method = "lm", se = FALSE, color = "blue") + 
  labs(title = "Gráfico de Regresión Lineal",
       x = "Semanas",
       y = "Peso")
print(grafico)

#Variables binarias

nac$educ_binaria <- ifelse(nac$educ_madre > 8, 1, 0)



nac$educ_nivel <- cut(nac$educ_madre,
                      breaks = c(-Inf, 8, 12, Inf),
                      labels = c("nivel basico", "nivel medio", "nivel superior"),
                      include.lowest = TRUE)

#modelos de regresion lineal

#modelo1

m1 <- lm(peso ~ educ_madre, data = nac)
summary(m1)

#modelo 2
m2 <- lm(peso ~ factor(educ_binaria), data=nac )
summary(m2)
tab_model(m2,show.se = TRUE, show.ci = FALSE)
#modelo3 

nac <- nac %>%
  mutate(educacion = factor(educ_nivel,
                            levels = c("nivel basico",
                                       "nivel medio",
                                       "nivel superior")))
m3 <- lm(peso ~ educacion, data = nac)
tab_model(m3,show.se = TRUE, show.ci = FALSE)
